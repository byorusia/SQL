# 最初の動物名照会

## 📖 問題文（日本語訳）

ANIMAL_INS テーブルは動物保護所に入ってきた動物の情報を含むテーブルです。

動物保護所に最も早く入ってきた動物の名前を照会する SQL 文を作成してください。

## 📊 テーブル構造

### ANIMAL_INS テーブル

ANIMAL_ID、ANIMAL_TYPE、DATETIME、INTAKE_CONDITION、NAME、SEX_UPON_INTAKE は、それぞれ動物の ID、生物種、保護開始日、保護開始時の状態、名前、性別及び中性化の有無を表します。

| Column name      | Type        | Nullable |
| ---------------- | ----------- | -------- |
| ANIMAL_ID        | VARCHAR(N)  | FALSE    |
| ANIMAL_TYPE      | VARCHAR(N)  | FALSE    |
| DATETIME         | DATETIME    | FALSE    |
| INTAKE_CONDITION | VARCHAR(N)  | FALSE    |
| NAME             | VARCHAR(N)  | TRUE     |
| SEX_UPON_INTAKE  | VARCHAR(N)  | FALSE    |

**サンプルデータ:**

| ANIMAL_ID | ANIMAL_TYPE | DATETIME            | INTAKE_CONDITION | NAME     | SEX_UPON_INTAKE |
| --------- | ----------- | ------------------- | ---------------- | -------- | --------------- |
| A399552   | Dog         | 2013-10-14 15:38:00 | Normal           | Jack     | Neutered Male   |
| A379998   | Dog         | 2013-10-23 11:42:00 | Normal           | Disciple | Intact Male     |
| A370852   | Dog         | 2013-11-03 15:04:00 | Normal           | Katie    | Spayed Female   |
| A403564   | Dog         | 2013-11-18 17:03:00 | Normal           | Anna     | Spayed Female   |

## 🎯 期待される出力

| NAME |
| ---- |
| Jack |

## 💡 解答

```sql
SELECT
    NAME
FROM ANIMAL_INS
ORDER BY DATETIME ASC
LIMIT 1;
```

## 📝 解説

### アプローチ

1. ANIMAL_INS テーブルから NAME カラムを選択
2. DATETIME で昇順ソート（最も古い日時が最初に来る）
3. LIMIT 1 で最初の 1 件のみを取得

### 解答の流れ

**保護開始日時の順序：**

1. 2013-10-14 15:38:00 → Jack（最も早い）
2. 2013-10-23 11:42:00 → Disciple
3. 2013-11-03 15:04:00 → Katie
4. 2013-11-18 17:03:00 → Anna

**結果：**

最も早い日時（2013-10-14 15:38:00）のレコードは Jack なので、Jack が出力されます。

### 学習ポイント

- **ORDER BY + LIMIT**: ソート後に件数を制限して最大値・最小値を取得
- **LIMIT 句**: 結果セットの件数を制限
- **日時のソート**: DATETIME 型データを昇順・降順でソート
- **Top-N クエリ**: 最初の N 件を取得する基本パターン

### LIMIT 句の基本

```sql
-- 最初の 1 件
LIMIT 1

-- 最初の 5 件
LIMIT 5

-- オフセットを使用（6 件目から 5 件取得）
LIMIT 5 OFFSET 5

-- 短縮形（5 件スキップして 5 件取得）
LIMIT 5, 5
```

### 最小値・最大値の取得方法

**方法 1: ORDER BY + LIMIT（推奨：シンプル）**

```sql
-- 最小値（最も古い日時）
SELECT NAME FROM ANIMAL_INS ORDER BY DATETIME ASC LIMIT 1;

-- 最大値（最も新しい日時）
SELECT NAME FROM ANIMAL_INS ORDER BY DATETIME DESC LIMIT 1;
```

**方法 2: サブクエリ（複雑だが汎用的）**

```sql
-- 最小値
SELECT NAME
FROM ANIMAL_INS
WHERE DATETIME = (SELECT MIN(DATETIME) FROM ANIMAL_INS);
```

この問題では ORDER BY + LIMIT の方がシンプルで効率的です。

### ASC と DESC

- **ASC**: 昇順（Ascending）- 小さい → 大きい、古い → 新しい
- **DESC**: 降順（Descending）- 大きい → 小さい、新しい → 古い

```sql
-- 最も古いレコード
ORDER BY DATETIME ASC LIMIT 1

-- 最も新しいレコード
ORDER BY DATETIME DESC LIMIT 1
```

### Top-N パターンの応用

```sql
-- 上位 3 件（最も古い 3 匹）
SELECT NAME FROM ANIMAL_INS ORDER BY DATETIME ASC LIMIT 3;

-- 下位 3 件（最も新しい 3 匹）
SELECT NAME FROM ANIMAL_INS ORDER BY DATETIME DESC LIMIT 3;

-- 2 番目に古い動物（オフセット使用）
SELECT NAME FROM ANIMAL_INS ORDER BY DATETIME ASC LIMIT 1 OFFSET 1;
```

## 🔑 キーワード

- SELECT（特定カラム）
- ORDER BY（日時ソート）
- LIMIT 句
- Top-N クエリ
- 最小値取得

# 果物ベースアイスクリーム照会

## 📖 問題文（日本語訳）

以下はアイスクリーム店の上半期注文情報を含む FIRST_HALF テーブルと、アイスクリーム成分に関する情報を含む ICECREAM_INFO テーブルです。

FIRST_HALF テーブルと ICECREAM_INFO テーブルから、上半期アイスクリーム総注文量が 3,000 より高く、アイスクリームの主成分が果物であるアイスクリームの味を、総注文量が大きい順序で照会する SQL 文を作成してください。

## 📊 テーブル構造

### FIRST_HALF テーブル

SHIPMENT_ID、FLAVOR、TOTAL_ORDER は、それぞれアイスクリーム工場からアイスクリーム店までの出荷番号、アイスクリームの味、上半期アイスクリーム総注文量を表します。FIRST_HALF テーブルの主キーは FLAVOR です。

| Column name | Type       | Nullable |
| ----------- | ---------- | -------- |
| SHIPMENT_ID | INT(N)     | FALSE    |
| FLAVOR      | VARCHAR(N) | FALSE    |
| TOTAL_ORDER | INT(N)     | FALSE    |

**サンプルデータ:**

| SHIPMENT_ID | FLAVOR          | TOTAL_ORDER |
| ----------- | --------------- | ----------- |
| 101         | chocolate       | 3200        |
| 102         | vanilla         | 2800        |
| 103         | mint_chocolate  | 1700        |
| 104         | caramel         | 2600        |
| 105         | white_chocolate | 3100        |
| 106         | peach           | 2450        |
| 107         | watermelon      | 2150        |
| 108         | mango           | 2900        |
| 109         | strawberry      | 3100        |
| 110         | melon           | 3150        |
| 111         | orange          | 2900        |
| 112         | pineapple       | 2900        |

### ICECREAM_INFO テーブル

FLAVOR、INGREDIENT_TYPE は、それぞれアイスクリームの味、アイスクリームの成分タイプを表します。INGREDIENT_TYPE にはアイスクリームの主成分が砂糖なら sugar_based と入力され、アイスクリームの主成分が果物なら fruit_based と入力されます。ICECREAM_INFO の主キーは FLAVOR です。ICECREAM_INFO テーブルの FLAVOR は FIRST_HALF テーブルの FLAVOR の外部キーです。

| Column name     | Type       | Nullable |
| --------------- | ---------- | -------- |
| FLAVOR          | VARCHAR(N) | FALSE    |
| INGREDIENT_TYPE | VARCHAR(N) | FALSE    |

**サンプルデータ:**

| FLAVOR          | INGREDIENT_TYPE |
| --------------- | --------------- |
| chocolate       | sugar_based     |
| vanilla         | sugar_based     |
| mint_chocolate  | sugar_based     |
| caramel         | sugar_based     |
| white_chocolate | sugar_based     |
| peach           | fruit_based     |
| watermelon      | fruit_based     |
| mango           | fruit_based     |
| strawberry      | fruit_based     |
| melon           | fruit_based     |
| orange          | fruit_based     |
| pineapple       | fruit_based     |

## 🎯 期待される出力

| FLAVOR     |
| ---------- |
| melon      |
| strawberry |

## 💡 解答

```sql
SELECT F.FLAVOR
FROM FIRST_HALF AS F
INNER JOIN ICECREAM_INFO AS I
    ON F.FLAVOR = I.FLAVOR
WHERE F.TOTAL_ORDER > 3000
    AND I.INGREDIENT_TYPE = 'fruit_based'
ORDER BY F.TOTAL_ORDER DESC;
```

## 📝 解説

### アプローチ

1. FIRST_HALF と ICECREAM_INFO を FLAVOR で内部結合
2. WHERE 句で総注文量が 3,000 より大きい条件を指定
3. WHERE 句で成分タイプが果物ベース（fruit_based）の条件を追加
4. 総注文量の降順（DESC）でソート

### 解答の流れ

上半期総注文量が 3,000 より高いアイスクリームは：chocolate（3200）、strawberry（3100）、melon（3150）、white_chocolate（3100）です。

この中で主成分が果物（fruit_based）のものは：strawberry と melon です。

総注文量の降順でソートすると：melon（3150）、strawberry（3100）の順になります。

### 学習ポイント

- **INNER JOIN**: 両方のテーブルに一致するレコードのみを取得
- **複数条件の WHERE 句**: AND を使用して複数の条件を組み合わせる
- **ORDER BY DESC**: 降順ソートで大きい値から順に表示
- **テーブルエイリアス**: F と I を使用してクエリを簡潔に記述

## 🔑 キーワード

- INNER JOIN
- WHERE（複数条件）
- AND 演算子
- ORDER BY DESC
- テーブルエイリアス

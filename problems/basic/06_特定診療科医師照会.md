# 特定診療科医師照会

## 📖 問題文（日本語訳）

以下は総合病院に属する医師情報を含む DOCTOR テーブルです。

DOCTOR テーブルから診療科が胸部外科（CS）または一般外科（GS）の医師の名前、医師 ID、診療科、雇用日を照会する SQL 文を作成してください。

この時、結果は雇用日を基準に降順ソートし、雇用日が同じ場合は名前を基準に昇順ソートしてください。

## 📊 テーブル構造

### DOCTOR テーブル

DR_NAME、DR_ID、LCNS_NO、HIRE_YMD、MCDP_CD、TLNO は、それぞれ医師名、医師 ID、免許番号、雇用日、診療科コード、電話番号を表します。

| Column name | Type        | Nullable |
| ----------- | ----------- | -------- |
| DR_NAME     | VARCHAR(20) | FALSE    |
| DR_ID       | VARCHAR(10) | FALSE    |
| LCNS_NO     | VARCHAR(30) | FALSE    |
| HIRE_YMD    | DATE        | FALSE    |
| MCDP_CD     | VARCHAR(6)  | TRUE     |
| TLNO        | VARCHAR(50) | TRUE     |

**サンプルデータ:**

| DR_NAME  | DR_ID      | LCNS_NO    | HIRE_YMD   | MCDP_CD | TLNO        |
| -------- | ---------- | ---------- | ---------- | ------- | ----------- |
| ルフィ   | DR20090029 | LC00010001 | 2009-03-01 | CS      | 01085482011 |
| パティ   | DR20090001 | LC00010901 | 2009-07-01 | CS      | 01085220122 |
| ポロロ   | DR20170123 | LC00091201 | 2017-03-01 | GS      | 01034969210 |
| ティガー | DR20100011 | LC00011201 | 2010-03-01 | NP      | 01034229818 |
| プンバ   | DR20090231 | LC00011302 | 2015-11-01 | OS      | 01049840278 |
| ティモン | DR20090112 | LC00011162 | 2010-03-01 | FM      | 01094622190 |
| ニモ     | DR20200012 | LC00911162 | 2020-03-01 | CS      | 01089483921 |
| オーロラ | DR20100031 | LC00010327 | 2010-11-01 | OS      | 01098428957 |
| ジャスミン | DR20100032 | LC00010192 | 2010-03-01 | GS      | 01023981922 |
| ベル     | DR20100039 | LC00010562 | 2010-07-01 | GS      | 01058390758 |

## 🎯 期待される出力

| DR_NAME    | DR_ID      | MCDP_CD | HIRE_YMD   |
| ---------- | ---------- | ------- | ---------- |
| ニモ       | DR20200012 | CS      | 2020-03-01 |
| ポロロ     | DR20170123 | GS      | 2017-03-01 |
| ベル       | DR20100039 | GS      | 2010-07-01 |
| ジャスミン | DR20100032 | GS      | 2010-03-01 |
| パティ     | DR20090001 | CS      | 2009-07-01 |
| ルフィ     | DR20090029 | CS      | 2009-03-01 |

## 💡 解答

```sql
SELECT
    DR_NAME,
    DR_ID,
    MCDP_CD,
    DATE_FORMAT(HIRE_YMD, '%Y-%m-%d') AS HIRE_YMD
FROM DOCTOR
WHERE MCDP_CD IN ('CS', 'GS')
ORDER BY HIRE_YMD DESC, DR_NAME ASC;
```

## 📝 解説

### アプローチ

1. DOCTOR テーブルから必要なカラム（DR_NAME、DR_ID、MCDP_CD、HIRE_YMD）を選択
2. WHERE 句で MCDP_CD が 'CS' または 'GS' のレコードをフィルタリング
3. DATE_FORMAT 関数で日付を 'YYYY-MM-DD' 形式に変換
4. HIRE_YMD 降順、DR_NAME 昇順でソート

### 解答の流れ

**診療科コード CS（胸部外科）または GS（一般外科）の医師：**
- ニモ（CS、2020-03-01）
- ポロロ（GS、2017-03-01）
- ベル（GS、2010-07-01）
- ジャスミン（GS、2010-03-01）
- パティ（CS、2009-07-01）
- ルフィ（CS、2009-03-01）

**ソート順：**
1. 雇用日降順：2020-03-01 → 2017-03-01 → 2010-07-01 → 2010-03-01 → 2009-07-01 → 2009-03-01
2. 同じ雇用日（2010-03-01）：ジャスミン < ベル（名前昇順）

### 学習ポイント

- **IN 演算子**: 複数の値のいずれかに一致するかをチェック
- **DATE_FORMAT 関数**: 日付データを指定した形式で出力
- **複数カラムソート**: ORDER BY で複数条件を指定（異なる順序も可能）
- **エイリアス**: DATE_FORMAT の結果を元のカラム名と同じ HIRE_YMD として出力

### IN 演算子 vs OR 条件

```sql
-- IN 演算子（推奨：読みやすい）
WHERE MCDP_CD IN ('CS', 'GS')

-- OR 条件（同じ意味）
WHERE MCDP_CD = 'CS' OR MCDP_CD = 'GS'
```

複数の値をチェックする場合は IN 演算子の方が簡潔で読みやすいです。

### DATE_FORMAT の主なフォーマット指定子

- `%Y`: 4 桁の年（2020）
- `%y`: 2 桁の年（20）
- `%m`: 2 桁の月（01-12）
- `%d`: 2 桁の日（01-31）
- `%H`: 2 桁の時（00-23）
- `%i`: 2 桁の分（00-59）
- `%s`: 2 桁の秒（00-59）

## 🔑 キーワード

- SELECT（特定カラム）
- WHERE 句
- IN 演算子
- DATE_FORMAT 関数
- ORDER BY（複数カラム、昇順・降順混在）
- エイリアス（AS）
